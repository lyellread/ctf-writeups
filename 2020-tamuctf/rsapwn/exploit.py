from pwn import *
from gmpy2 import mpz
from gmpy2 import isqrt
import gmpy2


def factors(n):
    n = mpz(n)
    t0=isqrt(n)+1
    counter=0
    t=t0+counter
    temp=isqrt((t*t)-n)
    while((temp*temp)!=((t*t)-n)):
        counter+=1
        t=t0+counter
        temp=isqrt((t*t)-n)
    s=temp
    p=t+s
    q=t-s
    return str(p),str(q)

#num = 99983660423453
#
#f = factors(num)
#print(f, num//f)
#assert f * num//f == num

def main():
    r = remote("challenges.tamuctf.com", 8573)
    print(r.recvuntil('Press enter when you are ready.\n'))
    r.send('\n')
    num = r.recvuntil('\n').strip()
    print("num", num)
    n1, n2 = factors(num)

    print(n1, n2)
    r.sendline(n1 + " " + n2)
    print(r.recvuntil('\n').strip())
    print(r.recvuntil('\n').strip())
    print(r.recvuntil('\n').strip())



if __name__ == '__main__':
    main()